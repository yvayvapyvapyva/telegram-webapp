<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="utf-8">
<title>Compass Map</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<script src="https://api-maps.yandex.ru/2.1/?apikey=ВАШ_API_КЛЮЧ&lang=ru_RU"></script>

<style>
html, body, #map {
    width: 100%;
    height: 100%;
    margin: 0;
}
</style>
</head>

<body>
<div id="map"></div>

<script>
let map, placemark;
let azimuth = 0;

ymaps.ready(() => {
    map = new ymaps.Map("map", {
        center: [0, 0],
        zoom: 18,
        type: 'yandex#satellite',
        controls: []
    });

    placemark = new ymaps.Placemark([0, 0], {}, {
        iconLayout: 'default#image',
        iconImageHref: createArrowSVG(0),
        iconImageSize: [40, 40],
        iconImageOffset: [-20, -20]
    });

    map.geoObjects.add(placemark);

    navigator.geolocation.watchPosition(pos => {
        const coords = [pos.coords.latitude, pos.coords.longitude];
        placemark.geometry.setCoordinates(coords);
        map.setCenter(coords);
    });
});

// компас
window.addEventListener('deviceorientationabsolute', e => {
    if (e.alpha !== null) {
        azimuth = Math.round(360 - e.alpha);
        placemark.options.set(
            'iconImageHref',
            createArrowSVG(azimuth)
        );
    }
});

// голос раз в 10 секунд
setInterval(() => {
    speechSynthesis.speak(
        new SpeechSynthesisUtterance("Азимут " + azimuth + " градусов")
    );
}, 10000);

// SVG стрелка
function createArrowSVG(angle) {
    const svg = `
    <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40">
        <g transform="rotate(${angle},20,20)">
            <polygon points="20,2 28,30 20,24 12,30" fill="red"/>
        </g>
    </svg>`;
    return 'data:image/svg+xml;utf8,' + encodeURIComponent(svg);
}
</script>
</body>
</html>
